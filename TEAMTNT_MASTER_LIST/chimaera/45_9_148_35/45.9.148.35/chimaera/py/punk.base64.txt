echo 'IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCiMgLSotIGNvZGluZzogdXRmLTggLSotCiMKIyAgICAgICAgICAgICB8CiMgICAgICAgICAgXCAgIHwgICAvCiMgICAgIC4gICAgIFwgIHwgIC8gICAgLgojICAgICAgYC0uX198XC9fXC98Xy4tJwojICAgIC5fXyAgXCAvICAgICBgLi8gIAojICAgICAgIGAtICAgICAgICBAfAojICAgICAgLi0nYC4gICEhICAgIC0gICBwdW5rLnB5IC0gdW5peCBTU0ggcG9zdC1leHBsb2l0YXRpb24gMTMzNyB0b29sCiMgICAgICcgICAgIGAgICEgIF9fLicgIENvcHlyaWdodCAoQykgMjAxOCA8IEdpdXNlcHBlIGByM3ZuYCBDb3J0aSA+CiMgICAgICAgICAgIF8pX19fKCAgICAgIGh0dHBzOi8veGZpbHRyYXRlZC5jb20KIwojIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiMgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKIyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvcgojIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiMKIyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKIyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgojIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKIyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgojCiMgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UKIyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KCmltcG9ydCBvcwppbXBvcnQgc3lzCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBiYXNlNjQKaW1wb3J0IGhhc2hsaWIKaW1wb3J0IHJlCmltcG9ydCBzb2NrZXQKaW1wb3J0IHN0cnVjdAppbXBvcnQgaG1hYwppbXBvcnQgYmluYXNjaWkKCnRyeTogCiAgICBpbXBvcnQgcXVldWUgYXMgcXVldWUKZXhjZXB0IEltcG9ydEVycm9yOgogICAgaW1wb3J0IFF1ZXVlIGFzIHF1ZXVlCgoKaG9tZXNCbGFja2xpc3QgPSBbIi9kZXYvbnVsbCIsIi92YXIvZW1wdHkiLCIvYmluIiwiL3NiaW4iXQpzaGVsbEJsYWNrbGlzdCA9IFsiL3NiaW4vbm9sb2dpbiIsIi9iaW4vZmFsc2UiLCIvdXNyL3NiaW4vbm9sb2dpbiIsIi9iaW4vc3luYyJdCmtub3duSG9zdHMgICAgID0gW10Kc3VjY2VzcyAgICAgICAgPSBbXQp1c2VycyAgICAgICAgICA9IFtdCnNzaEtleXMgICAgICAgID0gW10KCiAgIApjbGFzcyBTU0hUaHJlYWQodGhyZWFkaW5nLlRocmVhZCkgOgogCglkZWYgX19pbml0X18oc2VsZiwgcSwgdGlkLCBjcmVkZW50aWFscywgQ01EPSIiKSA6CgkJdGhyZWFkaW5nLlRocmVhZC5fX2luaXRfXyhzZWxmKQoJCXNlbGYucXVldWUgPSBxCgkJc2VsZi50aWQgPSB0aWQKCQlzZWxmLmNyZWRlbnRpYWxzID0gY3JlZGVudGlhbHMKIAoJZGVmIHJ1bihzZWxmKSA6CgkJd2hpbGUgVHJ1ZSA6CgkJCWhvc3QgPSBOb25lIAoJCQl0cnkgOgoJCQkJaG9zdCA9IHNlbGYucXVldWUuZ2V0KHRpbWVvdXQ9MSkKIAoJCQlleGNlcHQgCXF1ZXVlLkVtcHR5IDoKCQkJCXJldHVybgogCgkJCQoJCQlmb3IgdXNlciBpbiB1c2VyczoKCQkJCWZvciBrZXlzIGluIHNzaEtleXM6CgkJCQkJdHJ5OgoJCQkJCQlpZiBpbnQob3Muc3lzdGVtKCJzc2ggLW9CYXRjaE1vZGU9eWVzIC1vU3RyaWN0SG9zdEtleUNoZWNraW5nPW5vIC1vUGFzc3dvcmRBdXRoZW50aWNhdGlvbj1ubyAtb0Nvbm5lY3RUaW1lb3V0PTggJXNAJXMgLWkgJXMgLXEgZXhpdCIgJSAodXNlcixob3N0LGtleSApKSkgPT0gMDoKCQkJCQkJCXNlbGYuY3JlZGVudGlhbHMucHV0KHVzZXIrIjoiK2hvc3QrIjoiK2tleSkKCgkJCQkJCQlpZiB1c2VyKyI6Iitob3N0KyI6IitrZXkgbm90IGluIHN1Y2Nlc3M6CgkJCQkJCQkJc3lzLnN0ZG91dC53cml0ZSAoIlwwMzNbOTJtWypdXDAzM1swbSBHb3QgXDAzM1s5Mm0lc0Alc1wwMzNbMG0gd2l0aCBcMDMzWzkybVwiJXNcIlwwMzNbMG0ga2V5LlxuIiAlICh1c2VyLGhvc3Qsa2V5KSkKCQkJCQkJCQlzdWNjZXNzLmFwcGVuZCh1c2VyKyI6Iitob3N0KyI6IitrZXkpCgkJCQkJCQkKCQkJCQkJCWlmIENNRCAhPSAnJzoKCQkJCQkJCQlzeXMuc3Rkb3V0LndyaXRlICgiXDAzM1s5Mm1bKl1cMDMzWzBtIEV4ZWN1dGluZyBcMDMzWzkybSVzXDAzM1swbS5cbiIgJSAoQ01EKSkKCQkJCQkJCQlvcy5zeXN0ZW0oInNzaCAtb0JhdGNoTW9kZT15ZXMgLW9TdHJpY3RIb3N0S2V5Q2hlY2tpbmc9bm8gLW9QYXNzd29yZEF1dGhlbnRpY2F0aW9uPW5vIC1vQ29ubmVjdFRpbWVvdXQ9OCAlc0AlcyAtaSAlcyAtcSAtdCBcIiVzXCIgIiAlICh1c2VyLGhvc3Qsa2V5LENNRCkpCgkJCQkJZXhjZXB0OgoJCQkJCQlwYXNzCiAKIAoJCQlzZWxmLnF1ZXVlLnRhc2tfZG9uZSgpCgoKY2xhc3MgQ3JhY2tUaHJlYWQodGhyZWFkaW5nLlRocmVhZCkgOgogCglkZWYgX19pbml0X18oc2VsZiwgcSwgdGlkLCBpcHMsIG1hZ2ljLCBzYWx0LCBoYXNoZWQpIDoKCQl0aHJlYWRpbmcuVGhyZWFkLl9faW5pdF9fKHNlbGYpCgkJc2VsZi5xdWV1ZSAgPSBxCgkJc2VsZi50aWQgICAgPSB0aWQKCQlzZWxmLmlwcyAgICA9IGlwcwoJCXNlbGYubWFnaWMgID0gbWFnaWMKCQlzZWxmLnNhbHQgICA9IGJhc2U2NC5iNjRkZWNvZGUoc2FsdCkKCQlzZWxmLmhhc2hlZCA9IGhhc2hlZAoKIAoJZGVmIHJ1bihzZWxmKSA6CgkJd2hpbGUgVHJ1ZSA6CgkJCWhvc3QgPSBOb25lIAoJCQl0cnkgOgoJCQkJaXBfdHJ5ID0gc2VsZi5xdWV1ZS5nZXQodGltZW91dD0xKQogCgkJCWV4Y2VwdCAJcXVldWUuRW1wdHkgOgoJCQkJcmV0dXJuCgoKCQkJaCA9IGhtYWMubmV3KHNlbGYuc2FsdCwgbXNnPWlwX3RyeS5lbmNvZGUoKSwgZGlnZXN0bW9kPWhhc2hsaWIuc2hhMSkgIyBGSVhNRQoJCQlpcF9oYXNoID0gYmFzZTY0LmI2NGVuY29kZShoLmRpZ2VzdCgpKS5kZWNvZGUoKQoKCgkJCWlmIGlwX2hhc2ggPT0gc2VsZi5oYXNoZWQ6CgkJCQlrbm93bkhvc3RzLmFwcGVuZChpcF90cnkpCgkJCQlzeXMuc3Rkb3V0LndyaXRlICgiXDAzM1s5Mm1bKl1cMDMzWzBtIEZvdW5kIFwwMzNbOTJtJXNcMDMzWzBtXG4iICUgKGlwX3RyeSkpCgoJCQkjc3lzLnN0ZG91dC53cml0ZSAoIlxuLS0tLS1cbmlwOiAiK2lwX3RyeSsiXG4gc2FsdDogIitzZWxmLnNhbHQuZGVjb2RlKCkrIlxuIG91dHB1dDogIitpcF9oYXNoKyJcbnRhcmdldDogIitzZWxmLmhhc2hlZCkKCgkJCXNlbGYucXVldWUudGFza19kb25lKCkKCgpjbGFzcyBhdHRhY2sob2JqZWN0KToKCglkZWYgX19pbml0X18oc2VsZiwgY21kLCB0aHJlYWRzKToKCQlzZWxmLmNtZCA9IGNtZAoJCXNlbGYudGhyZWFkcyA9IHRocmVhZHMKCglkZWYgcnVuKHNlbGYpOgoKCQlxICAgICAgICAgICA9IHF1ZXVlLlF1ZXVlKCkKCQljcmVkZW50aWFscyA9IHF1ZXVlLlF1ZXVlKCkKCgkJdGhyZWFkcyA9IFtdCgkJZm9yIGkgaW4gcmFuZ2UoMSwgc2VsZi50aHJlYWRzKSA6ICMgTnVtYmVyIG9mIHRocmVhZHMKCQkJd29ya2VyID0gU1NIVGhyZWFkKHEsIGksIGNyZWRlbnRpYWxzLCBzZWxmLmNtZCkgCgkJCXdvcmtlci5zZXREYWVtb24oVHJ1ZSkKCQkJd29ya2VyLnN0YXJ0KCkKCQkJdGhyZWFkcy5hcHBlbmQod29ya2VyKQoKCQlmb3IgaG9zdCBpbiBrbm93bkhvc3RzOgoJCQlxLnB1dChob3N0KQoKCQlxLmpvaW4oKQoJCSAKCQkjIHdhaXQgZm9yIGFsbCB0aHJlYWRzIHRvIGV4aXQgCgkJaWYgbm90IGNyZWRlbnRpYWxzLmVtcHR5KCk6CgkJCW91dCA9IChjcmVkZW50aWFscy5nZXQoKSkuc3BsaXQoIjoiKQoJCWVsc2U6CgkJCXJldHVybiBGYWxzZQoJCSAKCQlmb3IgaXRlbSBpbiB0aHJlYWRzIDoKCQkJaXRlbS5qb2luKCkKCgkJcmV0dXJuIG91dFswXSwgb3V0WzFdICMgT3V0cHV0IGF0dGFjazogdXNlciwgaG9zdAoKCgoKCmNsYXNzIGNyYWNrX2hvc3Qob2JqZWN0KToKCglkZWYgX19pbml0X18oc2VsZiwgaG9zdF9zdHJpbmcsIHN1Ym5ldCwgdGhyZWFkcyk6CgkJIiIiIGNyYWNrIGFuIGVuY3J5cHRlZCBrbm93biBob3N0ICIiIgoKCQlzZWxmLm1hZ2ljICAgPSBob3N0X3N0cmluZy5zcGxpdCgifCIpWzFdCgkJc2VsZi5zYWx0ICAgID0gaG9zdF9zdHJpbmcuc3BsaXQoInwiKVsyXQoJCXNlbGYuaGFzaGVkICA9IGhvc3Rfc3RyaW5nLnNwbGl0KCJ8IilbM10uc3BsaXQoIiAiKVswXQoJCXNlbGYuc3VibmV0ICA9IHN1Ym5ldCAjIFRPRE8KCQlzZWxmLnRocmVhZHMgPSB0aHJlYWRzCgoJZGVmIHJ1bihzZWxmKToKCgkJcSAgICAgICAgICAgPSBxdWV1ZS5RdWV1ZSgpCgkJaXBzICAgICAgICAgPSBxdWV1ZS5RdWV1ZSgpCgoJCXRocmVhZHMgPSBbXQoJCWZvciBpIGluIHJhbmdlKDEsIHNlbGYudGhyZWFkcykgOiAjIE51bWJlciBvZiB0aHJlYWRzCgkJCXdvcmtlciA9IENyYWNrVGhyZWFkKHEsIGksIGlwcywgc2VsZi5tYWdpYywgc2VsZi5zYWx0LCBzZWxmLmhhc2hlZCkgCgkJCXdvcmtlci5zZXREYWVtb24oVHJ1ZSkKCQkJd29ya2VyLnN0YXJ0KCkKCQkJdGhyZWFkcy5hcHBlbmQod29ya2VyKQoKCQlmb3IgaG9zdCBpbiBpcHY0X3JhbmdlKHNlbGYuc3VibmV0KTogIyBUT0RPCgkJCXEucHV0KHN0cihob3N0KSkgICAgICAgICAgICAgICMgVE9ETwoKCQlxLmpvaW4oKQoJCSAKCQkjIHdhaXQgZm9yIGFsbCB0aHJlYWRzIHRvIGV4aXQgCgkJaWYgbm90IGlwcy5lbXB0eSgpOgoJCQlvdXQgPSAoaXBzLmdldCgpKS5zcGxpdCgiOiIpCgkJZWxzZToKCQkJcmV0dXJuIEZhbHNlCgkJIAoJCWZvciBpdGVtIGluIHRocmVhZHMgOgoJCQlpdGVtLmpvaW4oKQoKCQlyZXR1cm4gb3V0WzBdLCBvdXRbMV0gIyBPdXRwdXQgYXR0YWNrOiB1c2VyLCBob3N0CgpkZWYgZGlzY292ZXJ5KGFyZ3MpOgoJIyBTZWFyY2ggdXNlcnMsIFNTSCBrZXlzIGFuZCBrbm93biBob3N0cwoKCWlmIGFyZ3MucGFzc3dkOgoJCSMgR2V0IHVzZXJzIGFuZCBob21lIHBhdGhzIGZyb20gcGFzc3dkCgkJRiA9IG9wZW4oIi9ldGMvcGFzc3dkIiwncicpCgoJCWZvciBsaW5lIGluIEY6CgkJCWlmIG5vdCBsaW5lLnN0YXJ0c3dpdGgoJyMnKTogI8Kgc2tpcCBjb21tZW50cwoKCQkJCXVzZXIgID0gbGluZS5zcGxpdCgiOiIpWzBdCgkJCQlob21lICA9IGxpbmUuc3BsaXQoIjoiKVs1XQoJCQkJc2hlbGwgPSBsaW5lLnNwbGl0KCI6IilbNl0ucmVwbGFjZSgiXG4iLCIiKQoKCQkJCWlmIGhvbWUgbm90IGluIGhvbWVzQmxhY2tsaXN0IGFuZCBzaGVsbCBub3QgaW4gc2hlbGxCbGFja2xpc3Q6CgoJCQkJCXVzZXJzLmFwcGVuZCh1c2VyKQoKCQkJCQkjY29sbGVjdCBrbm93biBob3N0cwoJCQkJCWlmIG9zLnBhdGguaXNmaWxlKGhvbWUgKyAiLy5zc2gva25vd25faG9zdHMiKToKCQkJCQkJRksgPSBvcGVuKGhvbWUgKyAiLy5zc2gva25vd25faG9zdHMiKQoJCQkJCQllbmNyeXB0ZWRfa25vd25ob3N0cyA9IEZhbHNlCgoJCQkJCQlmb3IgaG9zdCBpbiBGSzoKCQkJCQkJCWlmIG5vdCBob3N0LmZpbmQoInwiKSA+PSAwOiAjIHNlY3VyZSBrbm93bl9ob3N0cwoJCQkJCQkJCWlmIGhvc3QuZmluZCgiLCIpID49IDA6CgkJCQkJCQkJCWhvc3RuYW1lID0gaG9zdC5zcGxpdCgiICIpWzBdLnNwbGl0KCIsIilbMV0KCQkJCQkJCQllbHNlOgoJCQkJCQkJCQlob3N0bmFtZSA9IGhvc3Quc3BsaXQoIiAiKVswXQoJCQkJCQkJCWlmIGhvc3RuYW1lIG5vdCBpbiBrbm93bkhvc3RzOgoJCQkJCQkJCQlrbm93bkhvc3RzLmFwcGVuZChob3N0bmFtZSkKCQkJCQkJCWVsc2U6CgkJCQkJCQkJZW5jcnlwdGVkX2tub3duaG9zdHMgPSBUcnVlCgkJCQkJCQkJCQoKCQkJCQkJaWYgZW5jcnlwdGVkX2tub3duaG9zdHMgYW5kIGFyZ3MuY3JhY2sgPT0gIiI6CgkJCQkJCQlzeXMuc3Rkb3V0LndyaXRlICgiXDAzM1s5M21bIV1cMDMzWzBtIEVuY3J5cHRlZCBrbm93biBob3N0IGF0IFwwMzNbOTNtJXMvLnNzaC9rbm93bl9ob3N0c1wwMzNbMG1cbiIgJSBob21lICkKCQkJCQkJCXN5cy5zdGRvdXQud3JpdGUgKCJcMDMzWzkzbVshXVwwMzNbMG0gUnVuIHdpdGggXDAzM1s5M20tLWNyYWNrXDAzM1swbSBmbGFnIHRvIGJyZWFrIGl0XG4iKQoKCQkJCQkJZWxpZiBlbmNyeXB0ZWRfa25vd25ob3N0cyBhbmQgYXJncy5jcmFjayAhPSAiIjoKCQkJCQkJCSMgY3JhY2sgdGhlIGhhc2hlZCBrbm93biBob3N0cwoJCQkJCQkJc3lzLnN0ZG91dC53cml0ZSAoIlwwMzNbOTJtWypdXDAzM1swbSBDcmFja2luZyBrbm93biBob3N0cyBvbiBcMDMzWzkybSVzLy5zc2gva25vd25faG9zdHMuLi5cMDMzWzBtXG4iICUgaG9tZSApCgkJCQkJCQlGSyA9IG9wZW4oaG9tZSArICIvLnNzaC9rbm93bl9ob3N0cyIpCgkJCQkJCQlmb3IgaG9zdCBpbiBGSzoKCQkJCQkJCQlpZiBob3N0LmZpbmQoInwiKSA+PSAwOgoJCQkJCQkJCQljcmFja19vYmogPSBjcmFja19ob3N0KGhvc3QsIGFyZ3MuY3JhY2ssIGFyZ3MudGhyZWFkcykKCQkJCQkJCQkJY3JhY2tfb2JqLnJ1bigpCgkJCQkJCQkjc3lzLnN0ZG91dC53cml0ZSAoIlwwMzNbOTJtWypdXDAzM1swbSBDcmFja2luZyBkb25lLlxuIikKCgkJCQkJCUZLLmNsb3NlKCkKCgkJCQkJIyBjaGVjayB1c2VycyB3aXRoIHByaXZhdGUga2V5cwoJCQkJCWlmIG9zLnBhdGguaXNmaWxlKGhvbWUgKyAiLy5zc2gvaWRfcnNhIik6IAoJCQkJCQkjdGFyZ2V0c1t1c2VyXT1ob21lICsgIi8uc3NoL2lkX3JzYSIgICMgdXNlcm5hbWUgYW5kIGhvbWUgZGlyCgkJCQkJCWlmIGhvbWUrIi8uc3NoL2lkX3JzYSIgbm90IGluIHNzaEtleXM6CgkJCQkJCQlzc2hLZXlzLmFwcGVuZChob21lICsgIi8uc3NoL2lkX3JzYSIpCgkJRi5jbG9zZSgpCgoJIyBob21lIGRpcmVjdG9yeSBzY2FuCglmb3IgaG9tZXMgaW4gb3MubGlzdGRpcihhcmdzLmhvbWUpOgoJCWlmIGhvbWVzIG5vdCBpbiB1c2VyczoKCgkJCXVzZXJzLmFwcGVuZChob21lcykKCgkJCWlmIG9zLnBhdGguaXNmaWxlKGFyZ3MuaG9tZStob21lcyArICIvLnNzaC9pZF9yc2EiKToKCQkJCSN0YXJnZXRzW2hvbWVzXSA9IGhvbWVzICsgIi8uc3NoL2lkX3JzYSIKCQkJCWlmIGFyZ3MuaG9tZStob21lcyArICIvLnNzaC9pZF9yc2EiIG5vdCBpbiBzc2hLZXlzOgoJCQkJCXNzaEtleXMuYXBwZW5kKGFyZ3MuaG9tZStob21lcyArICIvLnNzaC9pZF9yc2EiKQoKCQkJaWYgb3MucGF0aC5pc2ZpbGUoYXJncy5ob21lK2hvbWVzICsgIi8uc3NoL2tub3duX2hvc3RzIik6CgkJCQlGSyA9IG9wZW4oYXJncy5ob21lK2hvbWVzICsgIi8uc3NoL2tub3duX2hvc3RzIikKCQkJCWVuY3J5cHRlZF9rbm93bmhvc3RzID0gRmFsc2UKCgkJCQlmb3IgaG9zdCBpbiBGSzoKCQkJCQlpZiBub3QgaG9zdC5maW5kKCJ8IikgPj0gMDogIyBzZWN1cmUga25vd25faG9zdHMKCQkJCQkJaWYgaG9zdC5maW5kKCIsIikgPj0gMDoKCQkJCQkJCWhvc3RuYW1lID0gaG9zdC5zcGxpdCgiICIpWzBdLnNwbGl0KCIsIilbMV0KCQkJCQkJZWxzZToKCQkJCQkJCWhvc3RuYW1lID0gaG9zdC5zcGxpdCgiICIpWzBdCgkJCQkJCWlmIGhvc3RuYW1lIG5vdCBpbiBrbm93bkhvc3RzOgoJCQkJCQkJa25vd25Ib3N0cy5hcHBlbmQoaG9zdG5hbWUpCgkJCQkJZWxzZToKCQkJCQkJZW5jcnlwdGVkX2tub3duaG9zdHMgPSBUcnVlCgoKCQkJCWlmIGVuY3J5cHRlZF9rbm93bmhvc3RzIGFuZCBhcmdzLmNyYWNrID09ICIiOgoJCQkJCXN5cy5zdGRvdXQud3JpdGUgKCJcMDMzWzkzbVshXVwwMzNbMG0gRW5jcnlwdGVkIGtub3duIGhvc3QgYXQgXDAzM1s5M20lcy8uc3NoL2tub3duX2hvc3RzXDAzM1swbVxuIiAlIGFyZ3MuaG9tZSApCgkJCQkJc3lzLnN0ZG91dC53cml0ZSAoIlwwMzNbOTNtWyFdXDAzM1swbSBSdW4gd2l0aCBcMDMzWzkzbSVzLS1jcmFja1wwMzNbMG0gZmxhZyB0byBicmVhayBpdFxuIikKCgkJCQllbGlmIGVuY3J5cHRlZF9rbm93bmhvc3RzIGFuZCBhcmdzLmNyYWNrICE9ICIiOgoJCQkJCSMgY3JhY2sgdGhlIGhhc2hlZCBrbm93biBob3N0cwoJCQkJCXN5cy5zdGRvdXQud3JpdGUgKCJcMDMzWzkybVsqXVwwMzNbMG0gQ3JhY2tpbmcga25vd24gaG9zdHMgb24gXDAzM1s5Mm0lcy8uc3NoL2tub3duX2hvc3RzLi4uXDAzM1swbVxuIiAlIGFyZ3MuaG9tZSApCgkJCQkJb3BlbihhcmdzLmhvbWUraG9tZXMgKyAiLy5zc2gva25vd25faG9zdHMiKQoJCQkJCWZvciBob3N0IGluIEZLOgoJCQkJCQlpZiBob3N0LmZpbmQoInwiKSA+PSAwOgoJCQkJCQkJY3JhY2tfb2JqID0gY3JhY2tfaG9zdChob3N0LCBhcmdzLmNyYWNrLCBhcmdzLnRocmVhZHMpCgkJCQkJCQljcmFja19vYmoucnVuKCkKCgkJCQlGSy5jbG9zZSgpCgkKCXJldHVybiBUcnVlCgojIEF2b2lkIGlwYWRkcmVzcyBsaWJyYXJ5IHNpbmNlIGlzIG5vdCBzdXBwb3J0ZWQgaW4gcHl0aG9uMiAKIyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDEzODY4NzQKZGVmIGluZXRfYXRvaShpcHY0X3N0cik6CiAgICAiIiJDb252ZXJ0IGRvdHRlZCBpcHY0IHN0cmluZyB0byBpbnQiIiIKICAgICMgbm90ZTogdXNlIHNvY2tldCBmb3IgcGFja2VkIGJpbmFyeSB0aGVuIHN0cnVjdCB0byB1bnBhY2sKICAgIHJldHVybiBzdHJ1Y3QudW5wYWNrKCIhSSIsIHNvY2tldC5pbmV0X2F0b24oaXB2NF9zdHIpKVswXQoKZGVmIGluZXRfaXRvYShpcHY0X2ludCk6CiAgICAiIiJDb252ZXJ0IGludCB0byBkb3R0ZWQgaXB2NCBzdHJpbmciIiIKICAgICMgbm90ZTogdXNlIHN0cnVjdCB0byBwYWNrIHRoZW4gc29ja2V0IHRvIHN0cmluZwogICAgcmV0dXJuIHNvY2tldC5pbmV0X250b2Eoc3RydWN0LnBhY2soIiFJIiwgaXB2NF9pbnQpKQoKZGVmIGlwdjRfcmFuZ2UoaXBhZGRyKToKICAgICIiIlJldHVybiBhIGxpc3Qgb2YgSVB2NCBhZGRyZXNzIGNvbnRpYW5lZCBpbiBhIGNpZHIgYWRkcmVzcyByYW5nZSIiIgogICAgIyBzcGxpdCBvdXQgZm9yIGV4YW1wbGUgMTkyLjE2OC4xLjE6MjIvMjQKICAgIGlwdjRfc3RyLCBwb3J0X3N0ciwgY2lkcl9zdHIgPSByZS5tYXRjaCgKICAgICAgICByJyhbXGRcLl0rKSg6XGQrKT8oL1xkKyk/JywgaXBhZGRyKS5ncm91cHMoKQoKICAgICMgY29udmVydCBhcyBuZWVkZWQKICAgIGlwdjRfaW50ID0gaW5ldF9hdG9pKGlwdjRfc3RyKQogICAgcG9ydF9zdHIgPSBwb3J0X3N0ciBvciAnJwogICAgY2lkcl9zdHIgPSBjaWRyX3N0ciBvciAnJwogICAgY2lkcl9pbnQgPSBpbnQoY2lkcl9zdHJbMTpdKSBpZiBjaWRyX3N0ciBlbHNlIDAKCiAgICAjIG1hc2sgaXB2NAogICAgaXB2NF9iYXNlID0gaXB2NF9pbnQgJiAoMHhmZmZmZmZmZiA8PCAoMzIgLSBjaWRyX2ludCkpCgogICAgIyBnZW5lcmF0ZSBsaXN0CiAgICBhZGRycyA9IFtpbmV0X2l0b2EoaXB2NF9iYXNlICsgdmFsKQogICAgICAgIGZvciB2YWwgaW4gcmFuZ2UoMSA8PCAoMzIgLSBjaWRyX2ludCkgKyAyKV0KICAgIHJldHVybiBhZGRycwoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CgoJc3lzLnN0ZG91dC53cml0ZSAoIiIiXDAzM1s5Mm0KICAgICAgICAgICAgIHwKICAgICAgICAgXCAgIHwgICAvCiAgICAuICAgICBcICB8ICAvICAgIC4KICAgICBgLS5fX3xcL19cL3xfLi0nCiAgIC5fXyAgXCAvICAgICBgLi8gIAogICAgICBgLSAgICAgICAgQHwKICAgICAuLSdgLiAgISEgICAgLSAgIFwwMzNbOTBtLT1bIFwwMzNbOTNtcHVuay5weSAtIHVuaXggU1NIIHBvc3QtZXhwbG9pdGF0aW9uIDEzMzcgdG9vbFwwMzNbOTJtCiAgICAnICAgICBgICAhICBfXy4nICBcMDMzWzkwbS09WyBcMDMzWzkzbWJ5IGByM3ZuYCAoIHR3OiBAcjN2bm4gKVwwMzNbOTJtCiAgICAgICAgICBfKV9fXyggICAgICBcMDMzWzkwbS09WyBcMDMzWzkzbWh0dHBzOi8veGZpbHRyYXRlZC5jb21cMDMzWzkybQogICAgICAgIFxuXDAzM1swbSIiIikKCgoJcGFyc2VyID0gYXJncGFyc2UuQXJndW1lbnRQYXJzZXIoKQoJcGFyc2VyLmFkZF9hcmd1bWVudCgnLS1ob21lJywgaGVscD0nY3VzdG9tIGhvbWUgcGF0aCcsZGVmYXVsdD0iL2hvbWUvIikKCXBhcnNlci5hZGRfYXJndW1lbnQoJy0tcnVuJywnLXInLCBoZWxwPSdydW4gY29tbWFuZHMgb24gY29tcHJvbWlzZWQgaG9zdHMnLGRlZmF1bHQ9IiIpCglwYXJzZXIuYWRkX2FyZ3VtZW50KCctLW5vLXBhc3N3ZCcsIGRlc3Q9J3Bhc3N3ZCcsIGFjdGlvbj0nc3RvcmVfZmFsc2UnLCBkZWZhdWx0PVRydWUsIGhlbHA9J3NraXAgcGFzc3dkIGNoZWNrJykKCXBhcnNlci5hZGRfYXJndW1lbnQoJy0tY3JhY2snLCctYycsIGhlbHA9J2NyYWNrIGhhc2hlZCBrbm93bl9ob3N0cyBmaWxlcycsZGVmYXVsdD0iIixtZXRhdmFyPSdzdWJuZXQnKQoJcGFyc2VyLmFkZF9hcmd1bWVudCgnLS10aHJlYWRzJywnLXQnLCB0eXBlPWludCwgaGVscD0nYnJ1dGUtZm9jaW5nIHRocmVhZHMnLGRlZmF1bHQ9NCkKCWFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncygpCgoJc3lzLnN0ZG91dC53cml0ZSAoIlwwMzNbOTJtWypdXDAzM1swbSBlbnVtZXJhdGluZyB2YWxpZCB1c2VycyB3aXRoIHNzaCBrZXlzLi4uXG4iKQoJZGlzY292ZXJ5KGFyZ3MpCglzeXMuc3Rkb3V0LndyaXRlICgiXDAzM1s5Mm1bKl1cMDMzWzBtIERvbmUuXG4iKQoKCWlmIGxlbihzc2hLZXlzKSA8PSAwOgoJCXN5cy5zdGRvdXQud3JpdGUgKCJcMDMzWzkzbVshXVwwMzNbMG0gTm8gdmFsaWQgU1NIIGtleXMgZm91bmQgb24gdGhlIHN5c3RlbS5cbiIpCgkJc3lzLmV4aXQoKQoJZWxzZToKCQlzeXMuc3Rkb3V0LndyaXRlICgiXDAzM1s5Mm1bKl1cMDMzWzBtIFNTSCBrZXlzIGZvdW5kOlxuXDAzM1s5Mm1cbiIpCgoJCWZvciBrZXkgaW4gc3NoS2V5czoKCQkJc3lzLnN0ZG91dC53cml0ZSAoIlx0IiArIGtleSArICJcbiIpCgoJaWYgbGVuKHVzZXJzKSA8PSAwOgoJCXN5cy5zdGRvdXQud3JpdGUgKCJcblwwMzNbOTNtWyFdXDAzM1swbSBObyB2YWxpZCB1c2VycyBmb3VuZCBvbiB0aGUgc3lzdGVtLlxuIikKCQlzeXMuZXhpdCgpCgllbHNlOgoJCXN5cy5zdGRvdXQud3JpdGUgKCJcblwwMzNbOTJtWypdXDAzM1swbSBVc2VycyBmb3VuZDpcblwwMzNbOTJtXG4iKQoKCQlmb3IgdXNlciBpbiB1c2VyczoKCQkJc3lzLnN0ZG91dC53cml0ZSAoIlx0IiArIHVzZXIgKyAiXG4iICkjKyAiIDo6ICIgKyB0YXJnZXRzW3VzZXJdCgoJaWYgbGVuKGtub3duSG9zdHMpIDw9IDA6CgkJc3lzLnN0ZG91dC53cml0ZSAoIlxuXDAzM1s5M21bIV1cMDMzWzBtIE5vIHZhbGlkIGtub3duIGhvc3RzIGZvdW5kIG9uIHRoZSBzeXN0ZW0uXG4iKQoJCXN5cy5leGl0KCkKCgllbHNlOgoJCXN5cy5zdGRvdXQud3JpdGUgKCJcblwwMzNbOTJtWypdXDAzM1swbSBrbm93biBob3N0cyBmb3VuZDpcblwwMzNbOTJtXG4iKQoKCQlmb3IgaG9zdCBpbiBrbm93bkhvc3RzOgoJCQlzeXMuc3Rkb3V0LndyaXRlICgiXHQiKyBob3N0KyAiXG4iKQoKCXN5cy5zdGRvdXQud3JpdGUgKCJcblwwMzNbOTJtWypdXDAzM1swbSBTdGFydGluZyBrZXlzIGJydXRlZm9yY2luZy4uLlxuIikKCUF0dGFjayA9IGF0dGFjayhhcmdzLnJ1biwgYXJncy50aHJlYWRzKQoKCUF0dGFjay5ydW4oKQoJc3lzLnN0ZG91dC53cml0ZSAoIlwwMzNbOTJtWypdXDAzM1swbSBBdHRhY2sgQ29tcGxldGUhXG4iKQoKCgoJCQoK' | base64 -d > /usr/bin/pu && chmod +x /usr/bin/pu
